<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3605601</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btt066</article-id><article-id pub-id-type="publisher-id">btt066</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Genetics and Population Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>A new way to protect privacy in large-scale genome-wide association studies</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kamm</surname><given-names>Liina</given-names></name><xref ref-type="aff" rid="btt066-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="btt066-AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="btt066-AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Bogdanov</surname><given-names>Dan</given-names></name><xref ref-type="aff" rid="btt066-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="btt066-AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Laur</surname><given-names>Sven</given-names></name><xref ref-type="aff" rid="btt066-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="btt066-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Vilo</surname><given-names>Jaak</given-names></name><xref ref-type="aff" rid="btt066-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="btt066-AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="btt066-COR1">*</xref></contrib></contrib-group><aff id="btt066-AFF1"><sup>1</sup>Institute of Computer Science, University of Tartu, Liivi 2, Tartu 50409, Estonia, <sup>2</sup>Software Technology and Applications Competence Center, &#x000dc;likooli 2, Tartu 51003, Estonia and <sup>3</sup>Cybernetica AS, &#x000dc;likooli 2, Tartu 51003, Estonia</aff><author-notes><corresp id="btt066-COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Jeffrey Barrett</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>4</month><year>2013</year></pub-date><pub-date pub-type="epub"><day>14</day><month>2</month><year>2013</year></pub-date><pub-date pub-type="pmc-release"><day>14</day><month>2</month><year>2013</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>29</volume><issue>7</issue><fpage>886</fpage><lpage>893</lpage><history><date date-type="received"><day>12</day><month>10</month><year>2012</year></date><date date-type="rev-recd"><day>27</day><month>1</month><year>2013</year></date><date date-type="accepted"><day>5</day><month>2</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2013. Published by Oxford University Press. All rights reserved.</copyright-statement><copyright-year>2013</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Motivation:</bold> Increased availability of various genotyping techniques has initiated a race for finding genetic markers that can be used in diagnostics and personalized medicine. Although many genetic risk factors are known, key causes of common diseases with complex heritage patterns are still unknown. Identification of such complex traits requires a targeted study over a large collection of data. Ideally, such studies bring together data from many biobanks. However, data aggregation on such a large scale raises many privacy issues.</p><p><bold>Results:</bold> We show how to conduct such studies without violating privacy of individual donors and without leaking the data to third parties. The presented solution has provable security guarantees.</p><p><bold>Contact:</bold>
<email>jaak.vilo@ut.ee</email></p><p><bold>Supplementary information:</bold>
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt066/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract><counts><page-count count="8"/></counts></article-meta></front><body><sec id="SEC1"><title>1 INTRODUCTION</title><p>Genome-wide association studies (GWAS) are one of the driving reasons behind the formation of nationwide and privately funded gene banks. Many chronic diseases and various cancer types are known to have genetic disposition factors (<xref ref-type="bibr" rid="btt066-B7">Chakravarti and Little, 2003</xref>; <xref ref-type="bibr" rid="btt066-B20">Lander and Schork, 1994</xref>). Although many underlying genetic signatures have been successfully identified for Mendelian disorders (<xref ref-type="bibr" rid="btt066-B15">Hamosh <italic>et al.</italic>, 2005</xref>), not many genetic risk factors for complex diseases have been discovered and confirmed. GWAS have identified some risk factors for type II diabetes (<xref ref-type="bibr" rid="btt066-B29">Prokopenko <italic>et al.</italic>, 2008</xref>) and for a few other common diseases (<xref ref-type="bibr" rid="btt066-B25">Manolio <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt066-B38">Wellcome Trust Case Control Consortium, 2007</xref>). GWAS have been modestly successful in pharmacogenetics (<xref ref-type="bibr" rid="btt066-B13">Grant and Hakonarson, 2007</xref>) and cancer research (<xref ref-type="bibr" rid="btt066-B35">Varghese and Easton, 2010</xref>). The size and structure of a study cohort are the main limiting factors in such studies, as the individual impact of genomic differences is usually small. Larger sample sizes increase the sensitivity of statistical tests and make it possible to apply a wide range of data-mining methods (<xref ref-type="bibr" rid="btt066-B26">Moore <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt066-B34">Szymczak <italic>et al.</italic>, 2009</xref>).</p><p>Ideally, studies should use nationwide and continent-wide patient cohorts. Formation of such cohorts is becoming feasible as genotyping costs are rapidly decreasing (<xref ref-type="bibr" rid="btt066-B16">Hayden, 2010</xref>; <xref ref-type="bibr" rid="btt066-B28">Pettersson <italic>et al.</italic>, 2009</xref>). In addition to nationwide biobanks, e.g. the UK Biobank, several personal genomics companies, such as 23andMe and Navigenics, already possess large and diverse patient cohorts. Biobanks are also forming large collaboration networks, such as P3G and HuGENet, to combine their patient cohorts and improve study quality. Privacy of individual gene donors is one of the biggest concerns in such projects. In many countries, genotype data are classified as sensitive data that can be handled by complying with specific restrictions, e.g. HIPAA in the USA and the Data Protection Directive in the European Union. These restrictions are justified, as a leak of genetic information can cause genome-based discrimination when more health-related patterns have been discovered.</p><p>Standard anonymization methods are not applicable to genotype data, as the data themselves are an ultimate identity code. Only 30&#x02013;80 out of 30 million single-nucleotide polymorphisms (SNPs) are needed to uniquely identify a person (<xref ref-type="bibr" rid="btt066-B21">Lin <italic>et al.</italic>, 2004</xref>). Moreover, the size of online genotype databases for genealogy studies, such as SGMF and YHRD, has made re-identification of anonymized genotype data a real threat (<xref ref-type="bibr" rid="btt066-B14">Gymrek <italic>et al.</italic>, 2013</xref>). Re-identification attacks (<xref ref-type="bibr" rid="btt066-B23">Malin and Sweeney, 2000</xref>, <xref ref-type="bibr" rid="btt066-B24">2002</xref>) based on combining inferred phenotypes with public data become practical, as the list of known associations between genotype and phenotypic traits (<xref ref-type="bibr" rid="btt066-B17">Hindorff <italic>et al.</italic>, 2009</xref>) evolves. Finally, <xref ref-type="bibr" rid="btt066-B18">Homer <italic>et al.</italic> (2008)</xref> showed that even aggregated pools of genomic data can leak private information. Although follow-up studies (<xref ref-type="bibr" rid="btt066-B37">Visscher and Hill, 2009</xref>) softened initial claims, the threat remains.</p><p>These findings created a debate whether one can promise privacy of genotype data in consent forms at all (<xref ref-type="bibr" rid="btt066-B27">P3G Consortium <italic>et al.</italic>, 2009</xref>). In the following, we show how to set up an infrastructure where the genotype data can be stored and processed so that none of the peers involved in the process can reconstruct the data, and thus the risk of accidental leaks and malicious data abuse is greatly reduced. The data analysis algorithms are executed in an oblivious manner so that only the desired outcome is revealed to the user and nothing else. Differently from well-known data perturbation and masking techniques (<xref ref-type="bibr" rid="btt066-B22">Machanavajjhala <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="btt066-B33">Sweeney, 2002</xref>), security guarantees are cryptographic. These guarantees depend on the computational complexity of well-established mathematical problems and not on the background knowledge of potential attackers. As such, the presented methodology is applicable to protecting biobanks and other medical databases.</p></sec><sec id="SEC2"><title>2 APPLICATION SCENARIOS</title><sec id="SEC2.1"><title>2.1 Privacy threats in medical studies</title><p>There are four principal groups of stakeholders in a typical medical study: data donors, data collectors, data analysts and supervisory organizations. Data donors consent to give their tissue samples and record other types of medical data, e.g. various questionnaires covering health issues. Data collectors are responsible for gathering and storing the data and keeping the donors&#x02019; confidentiality. The baseline requirements are forced by the laws, e.g. by the Genetic Information Nondiscrimination Act of 2008 in the USA. However, more stringent privacy guarantees can reduce data donors&#x02019; fears about data abuse and increase the participation rate.</p><p>Data collectors and supervisory organizations must guarantee that the data analysts (researchers) meet privacy restrictions. The confidentiality problem is somewhat smaller if the data analysts are from the same institution as the data collectors. If the analysts are not part of the organization, usually confidentiality agreements are signed between the parties. In most cases, collected data are stored in several databases so that direct personal information is not accessible to researchers. Instead, each patient gets a (pseudo) random barcode that links different databases together (<xref ref-type="bibr" rid="btt066-B10">De Moor <italic>et al.</italic>, 2003</xref>). On rare occasions, databases are merged either to identify specific persons or to form datasets needed for medical research.</p><p>All such solutions provide only partial security guarantees for data donors. Even if genetic data are stored separately and are not directly accessible, they must be (partially) released before the actual data analysis is carried out. Hence, a single fault by a data analyst or an insider attack might effectively obliterate all privacy guarantees. Therefore, compromises in confidentiality are needed for the creation of worldwide data banks for the scientific community.</p><p>These privacy issues are often alleviated with data perturbation and agglomeration techniques. For instance, the National Institutes of Health in the USA published the ratio of SNP alleles of various case&#x02013;control studies (<xref ref-type="bibr" rid="btt066-B8">Couzin, 2008</xref>) because it is essentially impossible to split a DNA mixture back to individual genotypes. However, it turned out that it is possible to detect whether a specific person is in the mixture or not (<xref ref-type="bibr" rid="btt066-B18">Homer <italic>et al.</italic>, 2008</xref>). As case&#x02013;control groups are often based on sensitive information, the data had to be removed.</p><p>Such unexpected security breaches are common for <italic>ad hoc</italic> perturbation or agglomeration methods because one often overlooks the effect of potential background knowledge to security. Although for certain problems perturbation and agglomeration methods can provide provable security, their overall applicability is limited and there are many known impossibility results (<xref ref-type="bibr" rid="btt066-B11">Dwork, 2011</xref>).</p></sec><sec id="SEC2.2"><title>2.2 A novel solution based on distributed storage</title><p>In this work, we propose a data collection system where sensitive data are secret shared among several independent entities. In brief, secret sharing assures that each party gets completely random-looking data. However, when all parties pool the data together sensitive values can be restored (see <xref ref-type="fig" rid="btt066-F1">Fig. 1</xref> for an example of how secret sharing works). Depending on the exact nature of the used secret sharing scheme, the privacy of shared values is preserved even if some of the parties holding shares collude (discussed further in the methods section). Hence, data can be shared without the fear of unexpected disclosure. Moreover, with the use of specific multi-party computation techniques, computations on secret shared data can be carried out without leaking any information (<xref ref-type="bibr" rid="btt066-B3">Bogdanov <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt066-B9">Damg&#x000e5;rd <italic>et al.</italic>, 2009</xref>). As a result, one can deploy a distributed computation environment that securely collects the data, does oblivious computations and returns the desired end results. Such systems have been successfully used for securing auctions (<xref ref-type="bibr" rid="btt066-B5">Bogetoft <italic>et al.</italic>, 2009</xref>) and analyzing financial data (<xref ref-type="bibr" rid="btt066-B4">Bogdanov <italic>et al.</italic>, 2012</xref>).
<fig id="btt066-F1" position="float"><label>Fig. 1.</label><caption><p>This figure illustrates how players A and B use a <italic>3-out-of-3</italic> additive secret sharing scheme to distribute two 32-bit integer values <italic>x</italic> and <italic>y</italic> to shares. The shares are sent to three servers that use the homomorphic property of the scheme to securely compute the sum of <italic>x</italic> and <italic>y</italic>. The shares of the sum are sent to player C, who reconstructs the result</p></caption><graphic xlink:href="btt066f1p"/></fig></p><p>There are other cryptographically secure computation techniques, e.g. (fully) homomorphic encryption. However, these techniques are significantly slower and less feasible on the large genome databases.</p><p><xref ref-type="fig" rid="btt066-F2">Figure 2</xref> depicts the overall workflow of secure GWAS. The core of such a system consists of three or more dedicated data centers (<italic>hosts</italic>) that are assumed to be independent organizations. For a worldwide study, these can be biobanks of different countries, regulatory authorities and patient interest groups. None of them have to be unconditionally trusted as long as too many of them do not collude with others. In particular, a successful attack against one or two of the data centers leaks no information and there even exists a recovery procedure from such attacks.
<fig id="btt066-F2" position="float"><label>Fig. 2.</label><caption><p>Secure GWAS consists of three major stages: data acquisition, formation of case&#x02013;control groups and statistical testing. Panel (<bold>A</bold>) depicts how these three stages are linked. Data are gathered and sent in securely coded shares to be stored. For statistical tests, case and control info is securely coded and applied to the securely stored data so that statistical analyses can be carried out. Panel (<bold>B</bold>) describes two alternative scenarios that can be used for secure storage of genotype and phenotype data. Scenario 1 depicts a situation where genotype data are entered into secure storage by the wetlab and phenotype data are entered by the donors themselves. Scenario 2 depicts a case where different gene banks send selected genotype and phenotype data to secure storage so they can make joint analyses on more data. Panel (<bold>C</bold>) describes how case and control groups can be formed. In the simplest case, researches have unrestricted access to phenotype data and can thus form case and control groups by themselves. In more complex settings, researchers do not have rights to access phenotype data, and hosts must use secure multi-party computations to construct case and control groups based on inclusion criteria</p></caption><graphic xlink:href="btt066f2p"/></fig></p><p>Genomic data are entered into the system by primary data collectors, e.g. wetlabs or different biobanks who collect and process the biological samples and who want to make joint analyses on shared data. For this operation, standard clinical protocols for genotyping are sufficient for security. At the end of the stage, the data are secret shared and transferred securely to the hosts.</p><p>Clinical data can be entered into the system either by the data donors themselves or by primary data collectors. The data are sent to the secure phenotype database in secret shared form to ensure confidentiality. In the analysis stage, the data analyst specifies the algorithm to be run on the secret shared data and waits for the results. For GWAS, the analyst first forms case and control groups. Next, the algorithm computes the necessary statistics and, finally, it releases the loci that show a statistically significant differentiation according to the specified case&#x02013;control groups. If the analyst wants to further examine a secured input value, all parties hosting the system must agree to disclose the respective shares.</p></sec><sec id="SEC2.3"><title>2.3 Potential advantages and drawbacks</title><p>We acknowledge that standard security measures are sufficient when the data are collected and analyzed by a single organization. Still, long-term projects can benefit from distributed data storage. First, a break-in into a data center yields no usable information. Second, splitting the data among independent organizations gives additional guarantees for the data donors, e.g. participants of commercial studies have no way of knowing what happens to their data if the project goes bankrupt. If one core center belongs to the state, participants know with greater certainty that their data cannot be abused. Third, other sources of private data can be incorporated into the analysis without privacy leaks. In particular, medical institutions can use their patient records to enhance analysis. The proposed solution provides a way to conduct the analysis so that neither the gene bank nor the medical institution releases their data.</p><p>The benefits of our approach are evident in collaborative studies between independent biobanks. As nothing beyond the desired test results are revealed during the computation, the solution provides superior privacy guarantees compared with alternatives based on meta-analysis techniques (<xref ref-type="bibr" rid="btt066-B39">Wolfson <italic>et al.</italic>, 2010</xref>), where each biobank first computes local summaries that are collaboratively merged into a final result. As a result, only a few summary values are disclosed. However, it is impossible to tell what exactly can be inferred about concealed values. Moreover, leakages of individual studies can cumulate as in DNA pools, where aggregation of minuscule effects on SNP frequencies allows us to make strong conclusions.</p><p>The biggest technical drawback of our solution is computational efficiency. As the data are secret shared between core centers and each oblivious computation step requires network communication, secure algorithms are several magnitudes slower than their insecure counterparts. Hence, we set up a controlled experiment to show that GWAS are feasible in our setting.</p><p>Finally, note that legal restrictions can form a major obstacle, as secret sharing is not as widely used as data encryption. However, legal issues are out of our scope as we analyze only the technological feasibility and potential advantages.</p></sec></sec><sec id="SEC3"><title>3 METHODS</title><sec id="SEC3.1"><title>3.1 Single-point analysis</title><p>The first step in GWAS is splitting individuals into case and control groups. These groups are formed based on phenotypic traits, such as presence and severity of disease. Although all four nucleotides can be located in a SNP site, it is common to consider two alleles, where the first one corresponds to the reference sequence and the other represents potential mutations. <xref ref-type="table" rid="btt066-T1">Table 1</xref> depicts the <inline-formula><inline-graphic xlink:href="btt066i2.jpg"/></inline-formula> contingency table for allele counts in case and control groups, where an allele is counted twice if it is present in both DNA strands (is homozygous). The test statistic for the standard <inline-formula><inline-graphic xlink:href="btt066i3.jpg"/></inline-formula> test is expressed as
<disp-formula id="btt066-M1"><label>(1)</label><graphic xlink:href="btt066m1"/></disp-formula>
and the test statistic for equiproportionality of the allele A in both groups is
<disp-formula id="btt066-M2"><label>(2)</label><graphic xlink:href="btt066m2"/></disp-formula>
For reasonable sample sizes, both test statistics are distributed according to <inline-formula><inline-graphic xlink:href="btt066i4.jpg"/></inline-formula> distribution with one degree of freedom. See the work of <xref ref-type="bibr" rid="btt066-B36">Visscher and Hellard (2003)</xref> for further details.
<table-wrap id="btt066-T1" position="float"><label>Table 1.</label><caption><p>Contingency table for the standard <inline-formula><inline-graphic xlink:href="btt066i1.jpg"/></inline-formula> test</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Group</th><th rowspan="1" colspan="1">Allele A</th><th rowspan="1" colspan="1">Allele B</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Cases</td><td rowspan="1" colspan="1"><italic>a</italic></td><td rowspan="1" colspan="1"><italic>c</italic></td></tr><tr><td rowspan="1" colspan="1">Controls</td><td rowspan="1" colspan="1"><italic>b</italic></td><td rowspan="1" colspan="1"><italic>d</italic></td></tr></tbody></table></table-wrap></p><p>These tests are accurate if the Hardy&#x02013;Weinberg equilibrium condition is satisfied for a particular SNP, whereas the Cochran&#x02013;Armitage test for trend can be used without this assumption. First, one must assemble the <inline-formula><inline-graphic xlink:href="btt066i5.jpg"/></inline-formula> contingency table depicted in <xref ref-type="table" rid="btt066-T2">Table 2</xref> and then compute the tests statistic as
<disp-formula id="btt066-M3"><label>(3)</label><graphic xlink:href="btt066m3"/></disp-formula>
where the weights <inline-formula><inline-graphic xlink:href="btt066i6.jpg"/></inline-formula> are chosen according to the suspected influence mechanism (usually <inline-formula><inline-graphic xlink:href="btt066i7.jpg"/></inline-formula> is an appropriate choice). As before, <italic>T</italic><sub>3</sub> is approximately distributed according to <inline-formula><inline-graphic xlink:href="btt066i8.jpg"/></inline-formula> distribution with one degree of freedom (<xref ref-type="bibr" rid="btt066-B1">Armitage, 1955</xref>; <xref ref-type="bibr" rid="btt066-B30">Sasieni, 1997</xref>).
<table-wrap id="btt066-T2" position="float"><label>Table 2.</label><caption><p>Contingency table for the Cochran&#x02013;Armitage test for trend</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Group</th><th rowspan="1" colspan="1">Allele AA</th><th rowspan="1" colspan="1">Allele AB</th><th rowspan="1" colspan="1">Allele BB</th><th rowspan="1" colspan="1">Total</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Cases</td><td rowspan="1" colspan="1"><italic>r</italic><sub>0</sub></td><td rowspan="1" colspan="1"><italic>r</italic><sub>1</sub></td><td rowspan="1" colspan="1"><italic>r</italic><sub>2</sub></td><td rowspan="1" colspan="1"><italic>m</italic><sub>1</sub></td></tr><tr><td rowspan="1" colspan="1">Controls</td><td rowspan="1" colspan="1"><italic>s</italic><sub>0</sub></td><td rowspan="1" colspan="1"><italic>s</italic><sub>1</sub></td><td rowspan="1" colspan="1"><italic>s</italic><sub>2</sub></td><td rowspan="1" colspan="1"><italic>m</italic><sub>2</sub></td></tr><tr><td rowspan="1" colspan="1">Total</td><td rowspan="1" colspan="1"><italic>n</italic><sub>0</sub></td><td rowspan="1" colspan="1"><italic>n</italic><sub>1</sub></td><td rowspan="1" colspan="1"><italic>n</italic><sub>2</sub></td><td rowspan="1" colspan="1"><italic>N</italic></td></tr></tbody></table></table-wrap></p><p>Transmission disequilibrium test (TDT) is applicable only if the data consist of parent&#x02013;child trios. The test measures whether one homozygous genotype is more over-represented than the other among affected children with heterozygous parents. For that we must first select trios where both parents have heterozygous genotype. Let <italic>u</italic> be the count of AA and <italic>v</italic> be the count of BB genotypes among children. Then the corresponding statistic
<disp-formula id="btt066-M4"><label>(4)</label><graphic xlink:href="btt066m4"/></disp-formula>
is again approximately distributed according to <inline-formula><inline-graphic xlink:href="btt066i9.jpg"/></inline-formula> distribution with one degree of freedom (<xref ref-type="bibr" rid="btt066-B31">Spielman <italic>et al.</italic>, 1993</xref>). Compared with previous tests, TDT is less sensitive to sampling artefacts but it also requires more structured data.</p></sec><sec id="SEC3.2"><title>3.2 Essentials of secure computing using secret sharing</title><p>A secure computation program is similar to a standard computer program. The difference between the two is in how the data are stored and processed. In a standard program, all values are processed publicly, whereas in a secure computation program, it is possible to specify which values are publicly visible and which are stored using techniques like secret sharing. These values can be used in computations without leaking their contents.</p><p>In our proposed solution, the data are secret shared between three or more hosts. The hosts themselves are not able to understand the values stored in their databases because each value looks like random noise owing to secret sharing. However, it is not trivial to perform computations on secret shared values as special secure multi-party computation protocols are required. The secure computation protocols used by the hosts preserve the privacy of the data during computation. The genotype data remain secure as long as the hosts do not share their databases of shares with each other. <xref ref-type="fig" rid="btt066-F1">Figure 1</xref> shows how secure multi-party computation works with secret sharing.</p><p>Secure computation can be used to perform most data processing operations. However, current solutions have some important differences compared with standard programming: (i) floating-point operations are significantly slower; (ii) comparison operations are slower than multiplication and addition; (iii) parallel execution of several operations is faster than sequential execution. Further details can be found in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt066/-/DC1">Supplementary Data</ext-link> and in the articles by <xref ref-type="bibr" rid="btt066-B3">Bogdanov <italic>et al.</italic> (2008)</xref>; <xref ref-type="bibr" rid="btt066-B9">Damg&#x000e5;rd <italic>et al.</italic> (2009)</xref> and <xref ref-type="bibr" rid="btt066-B12">Geisler (2010)</xref>.</p></sec><sec id="SEC3.3"><title>3.3 Secure storage of genotype data</title><p>Allele-level descriptions of genotypes are commonly stored as sequences of pairs where each pair is encoded as AA, AB, BB or NN, corresponding to a specific SNP. In GWAS, such data are converted into contingency tables as described in <xref ref-type="table" rid="btt066-T1">Tables 1</xref> and <xref ref-type="table" rid="btt066-T2">2</xref> depending on the analysis method being used.</p><p>This kind of counting, however, requires the use of string comparison operations that we would like to avoid, as they tend to be relatively slow in the case of share computing. Therefore, we represent each SNP as a pair of integers <inline-formula><inline-graphic xlink:href="btt066i10.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt066i11.jpg"/></inline-formula> counts the occurrences of the first allele and <inline-formula><inline-graphic xlink:href="btt066i12.jpg"/></inline-formula> the occurrences of the second allele in that SNP. That is, pairs AA, AB, BB, NN are encoded as (2,0), (1,1), (0,2), (0,0), respectively.</p><p>During the data collection phase, data donors, wetlabs or gene banks must first convert genotypes into the form described above and then secret share them between data hosts. As a result, we get a secret shared database where each column corresponds to an individual donor and there are two rows for each SNP (one for <inline-formula><inline-graphic xlink:href="btt066i13.jpg"/></inline-formula> and one for <inline-formula><inline-graphic xlink:href="btt066i14.jpg"/></inline-formula>). For each donor, we also store an ID value that uniquely identifies them.</p></sec><sec id="SEC3.4"><title>3.4 Secure formation of case&#x02013;control groups</title><p>To hide the identities of case and control group members, secret shared index vectors are used to specify the groups. An index vector <inline-formula><inline-graphic xlink:href="btt066i15.jpg"/></inline-formula> is a zero-one vector, where <italic>x<sub>i</sub></italic> corresponds to the <italic>i</italic>-th column in the database and <inline-formula><inline-graphic xlink:href="btt066i16.jpg"/></inline-formula> if and only if the <italic>i</italic>-th person is a member of the group that vector represents.</p><p>The two principal ways of how to construct case&#x02013;control groups can be seen in <xref ref-type="fig" rid="btt066-F2">Figure 2</xref> Panel C. In the first scenario, analysts have direct access to clinical data for a set of donors and, thus, are able to select case and control groups and construct index vectors. In the second scenario, phenotype data are also stored in secret shared form. In this case, there exists a secret shared database of phenotype attributes that consists of boolean attributes (e.g. has diabetes) and integers (e.g. age, blood pressure, height). To construct case and control groups, the analyst has to specify a logical expression based on which the hosts perform the necessary comparisons and output the two index vectors in secret shared form. For simple inclusion criteria, such as the one we used for experiments <inline-formula><inline-graphic xlink:href="btt066i17.jpg"/></inline-formula>, the corresponding secure comparison protocol is rather efficient.</p></sec><sec id="SEC3.5"><title>3.5 Secure assembly of contingency groups</title><p>Let <inline-formula><inline-graphic xlink:href="btt066i18.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt066i19.jpg"/></inline-formula> be index vectors for case and control groups, respectively. Let <inline-formula><inline-graphic xlink:href="btt066i20.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt066i21.jpg"/></inline-formula> be database columns for a particular SNP. Then the allele counts needed for tests (1) and (2) can be expressed as
<disp-formula id="btt066-M5"><label>(5)</label><graphic xlink:href="btt066m5"/></disp-formula>
Data hosts can securely compute shares of <inline-formula><inline-graphic xlink:href="btt066i22.jpg"/></inline-formula> for each SNP.</p><p>For the second contingency table, <inline-formula><inline-graphic xlink:href="btt066i23.jpg"/></inline-formula> for allele combinations AB, BB and NN. Similarly, <inline-formula><inline-graphic xlink:href="btt066i24.jpg"/></inline-formula> for AA, AB and NN and <inline-formula><inline-graphic xlink:href="btt066i25.jpg"/></inline-formula> for AA, BB and NN. We can express counts as
<disp-formula id="btt066-M6"><label>(6)</label><graphic xlink:href="btt066m6"/></disp-formula>
For TDT, we need to construct an index vector <inline-formula><inline-graphic xlink:href="btt066i26.jpg"/></inline-formula> for detecting heterozygous parents, i.e. <inline-formula><inline-graphic xlink:href="btt066i27.jpg"/></inline-formula> if at least one parent is homozygous and <inline-formula><inline-graphic xlink:href="btt066i28.jpg"/></inline-formula> otherwise. As <inline-formula><inline-graphic xlink:href="btt066i29.jpg"/></inline-formula> for homozygous allele combinations, we compute
<disp-formula id="btt066-M7"><label>(7)</label><graphic xlink:href="btt066m7"/></disp-formula>
To get shares of <italic>u</italic> and <italic>v</italic>, we can combine <italic>z</italic> with counts of AA and BB.</p></sec><sec id="SEC3.6"><title>3.6 Secure statistical testing</title><p>To determine whether a SNP is significant, one must check whether a <italic>P</italic>-value that is associated with a test statistic is below a pre-described significance level. Let <italic>&#x003b1;</italic> be the desired significance level and let <inline-formula><inline-graphic xlink:href="btt066i30.jpg"/></inline-formula> be such that <inline-formula><inline-graphic xlink:href="btt066i31.jpg"/></inline-formula> when <italic>T</italic> is distributed according to <inline-formula><inline-graphic xlink:href="btt066i32.jpg"/></inline-formula> distribution with one degree of freedom. A SNP is significant only if the corresponding test statistic is <inline-formula><inline-graphic xlink:href="btt066i33.jpg"/></inline-formula>.</p><p>Direct evaluation of formulae (1)&#x02013;(4) requires floating-point arithmetic, which we would like to avoid. Hence, we must rewrite the equation <inline-formula><inline-graphic xlink:href="btt066i34.jpg"/></inline-formula> in terms of integer operations. Let <inline-formula><inline-graphic xlink:href="btt066i35.jpg"/></inline-formula> be represented as a fraction <italic>p</italic>/<italic>q</italic> and the test statistic as a fraction <italic>m</italic>/<italic>n</italic>. Then the condition <inline-formula><inline-graphic xlink:href="btt066i36.jpg"/></inline-formula> is equivalent to the condition <inline-formula><inline-graphic xlink:href="btt066i37.jpg"/></inline-formula>. Both sides of this inequality can be securely computed and the inequality can be evaluated by using secure comparison operation, after which we can publish the comparison results to find out which SNPs are significant.</p><p>The significance level must be determined considering the multiple testing issue. The simplest way is to use Bonferroni correction, which is a conservative measure. It is also possible to perform privacy-preserving FDR correction. We estimate that the secure version of the standard FDR procedure takes about 10 min to complete for 262 264 SNPs. However, there are alternatives to the original algorithm that are significantly faster; see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt066/-/DC1">Supplementary Data</ext-link> for further details.</p></sec></sec><sec id="SEC4"><title>4 RESULTS</title><p>To demonstrate the feasibility of our approach, we used the S<sc>haremind</sc> multi-party computation platform (<xref ref-type="bibr" rid="btt066-B3">Bogdanov <italic>et al.</italic>, 2008</xref>) to implement core algorithms for GWAS. Our choice was mainly motivated by the efficiency and ease of use of the S<sc>haremind</sc> platform. Alternative platforms [Viff (<xref ref-type="bibr" rid="btt066-B9">Damg&#x000e5;rd <italic>et al.</italic>, 2009</xref>) and F<sc>airplay</sc>MP (<xref ref-type="bibr" rid="btt066-B2">Ben-David <italic>et al.</italic>, 2008</xref>)] should give similar results.</p><p>We used 270 genotypes from the H<sc>ap</sc>M<sc>ap</sc> project (<xref ref-type="bibr" rid="btt066-B19">International HapMap Consortium, 2003</xref>) measured with the Affymetrix Mapping 500K Array as the main data source. In each experiment, we divided the data randomly into case and control groups and performed genome-wide search for highly differentiated SNPs. For that we used cryptographically secure counterparts of standard statistical tests used in GWAS: two <inline-formula><inline-graphic xlink:href="btt066i38.jpg"/></inline-formula> tests for independence (<xref ref-type="bibr" rid="btt066-B36">Visscher and Hellard, 2003</xref>), Cochran&#x02013;Armitage test for trend (<xref ref-type="bibr" rid="btt066-B30">Sasieni, 1997</xref>) and TDT (<xref ref-type="bibr" rid="btt066-B31">Spielman <italic>et al.</italic>, 1993</xref>). As our algorithms return exactly the same outputs as original algorithms, we report only performance results for various sub-tasks. To show the variability of running times, we report the mean and standard deviation of four independent runs.</p><p>Each of the donors has 262 264 measured SNPs. First, we ran the algorithm on the data of 270 donors, and then we went on to test the data of 540, 810 and 1080 donors. We performed the experiments on three servers running S<sc>haremind</sc>. Each server was an off-the-shelf server-grade machine with 48 GB RAM of which less was used, twelve 2.93 GHz Intel Xeon (Westmere) cores of which two were used and a 1 Gb/s local area network (LAN) connection. At the moment, the network connection is the bottleneck in terms of algorithm running time; however, S<sc>haremind</sc> has been successfully used in real applications (<xref ref-type="bibr" rid="btt066-B4">Bogdanov <italic>et al.</italic>, 2012</xref>).</p><p>The time spent on data acquisition and secure storage does not depend on the statistical test used later on. It depends only on the number of SNPs and the number of gene donors. The average time it takes to encode and share the SNPs for the described case can be seen in <xref ref-type="table" rid="btt066-T3">Table 3</xref>. Note that secret sharing and uploading data are done only once for each dataset; hence, this is a single-time cost.
<table-wrap id="btt066-T3" position="float"><label>Table 3.</label><caption><p>Performance results for data upload and filtering</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Number of donors</th><th rowspan="1" colspan="1">Upload</th><th rowspan="1" colspan="1">Filtering</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">270 donors</td><td rowspan="1" colspan="1">12.0 min</td><td rowspan="1" colspan="1">0.51 s</td></tr><tr><td rowspan="1" colspan="1">540 donors</td><td rowspan="1" colspan="1">17.3 min</td><td rowspan="1" colspan="1">0.59 s</td></tr><tr><td rowspan="1" colspan="1">810 donors</td><td rowspan="1" colspan="1">23.2 min</td><td rowspan="1" colspan="1">0.63 s</td></tr><tr><td rowspan="1" colspan="1">1080 donors</td><td rowspan="1" colspan="1">29.4 min</td><td rowspan="1" colspan="1">0.68 s</td></tr></tbody></table></table-wrap></p><p>The time needed to form case&#x02013;control groups depends on the application scenario. When the analyst has direct access to phenotype data and can form case and control groups by herself/himself, then there is no computational overhead. In more involved cases, the case and control groups must be constructed based on secret shared phenotype attributes. In this case, the overhead depends on the complexity of inclusion criteria for case and control groups. Filtering results presented in <xref ref-type="table" rid="btt066-T3">Table 3</xref> show that formation of such groups can be done in seconds for typical inclusion criteria that consist of simple comparison operations mixed with logical conjunctives.</p><p>The time needed to perform the statistical test depends on the test, but in all cases it can be broken down into counting allele frequencies and evaluating test statistic. As <xref ref-type="table" rid="btt066-T4">Tables 4</xref> and <xref ref-type="table" rid="btt066-T5">5</xref> clearly show, the main performance bottleneck is frequency counting, which scales linearly w.r.t. the total number of SNP measurements. As our encoding is optimized for <inline-formula><inline-graphic xlink:href="btt066i70.jpg"/></inline-formula> test, a better encoding will enhance the performance of the Cochran&#x02013;Armitage tests but not beyond <inline-formula><inline-graphic xlink:href="btt066i71.jpg"/></inline-formula> results. The total duration of the analysis is the sum of the frequency analysis and evaluation, as the other parts have a negligible duration.
<table-wrap id="btt066-T4" position="float"><label>Table 4.</label><caption><p>Performance results for three different frequency analyses</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Number of donors</th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i39.jpg"/></inline-formula> tests</th><th rowspan="1" colspan="1">Cochran&#x02013;Armitage</th><th rowspan="1" colspan="1">TDT</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">270 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i40.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i41.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i42.jpg"/></inline-formula> min</td></tr><tr><td rowspan="1" colspan="1">540 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i43.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i44.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i45.jpg"/></inline-formula> min</td></tr><tr><td rowspan="1" colspan="1">810 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i46.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i47.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i48.jpg"/></inline-formula> min</td></tr><tr><td rowspan="1" colspan="1">1080 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i49.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i50.jpg"/></inline-formula> min</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i51.jpg"/></inline-formula> min</td></tr><tr><td rowspan="1" colspan="1">1080 donors (non-secure)</td><td rowspan="1" colspan="1">14 s</td><td rowspan="1" colspan="1">35 s</td><td rowspan="1" colspan="1">11 s</td></tr></tbody></table></table-wrap>
<table-wrap id="btt066-T5" position="float"><label>Table 5.</label><caption><p>Performance results for four test evaluation methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Number of donors</th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i52.jpg"/></inline-formula> test 1</th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i53.jpg"/></inline-formula> test 2</th><th rowspan="1" colspan="1">Cochran&#x02013; Armitage</th><th rowspan="1" colspan="1">TDT</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">270 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i54.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i55.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i56.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i57.jpg"/></inline-formula> s</td></tr><tr><td rowspan="1" colspan="1">540 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i58.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i59.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i60.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i61.jpg"/></inline-formula> s</td></tr><tr><td rowspan="1" colspan="1">810 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i62.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i63.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i64.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i65.jpg"/></inline-formula> s</td></tr><tr><td rowspan="1" colspan="1">1080 donors</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i66.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i67.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i68.jpg"/></inline-formula> s</td><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btt066i69.jpg"/></inline-formula> s</td></tr><tr><td rowspan="1" colspan="1">1080 donors (non-secure)</td><td rowspan="1" colspan="1">21 ms</td><td rowspan="1" colspan="1">20 ms</td><td rowspan="1" colspan="1">49 ms</td><td rowspan="1" colspan="1">11 ms</td></tr></tbody></table></table-wrap></p><p>The presented results clearly show that cryptographically secure evaluation of statistical tests on genome-wide scale is practically feasible. The expected running time is hours instead of a few minutes when computed non-securely. However, the latter is not a significant slowdown compared with the time needed to acquire the data if the secure analysis method is not used.</p></sec><sec id="SEC5"><title>5 DISCUSSION</title><p>Although the results prove the practical feasibility of cryptographically secure GWAS, the solution is also notably more resource demanding than the alternatives. We have to analyze further whether potential benefits outweigh costs. We consider three potential application scenarios and contrast our approach with the alternatives.</p><sec id="SEC5.1"><title>5.1 Collaboration between hospitals and biobanks</title><p>By now many countries have national or state-funded biobanks. There are more than 40 state-governed biobanks in Europe (<xref ref-type="bibr" rid="btt066-B40">Zika <italic>et al.</italic>, 2010</xref>) and many others in Asia and America (<xref ref-type="bibr" rid="btt066-B32">Swede <italic>et al.</italic>, 2007</xref>). Thus, there is a huge potential for collaborative studies between biobanks, hospitals and pharmaceutical companies. For example, if a clinical study indicates that a treatment is ineffective for a certain group of people, a genome-wide association study can indicate whether a particular set of SNPs can be used to predict efficacy of a treatment. In particular, GWAS have shown that certain SNP mutations influence efficacy of treatments for asthma, inflammatory bowel disease, coronary heart disease and cancer (<xref ref-type="bibr" rid="btt066-B13">Grant and Hakonarson, 2007</xref>).</p><p>Privacy issues are the major obstacle in such studies: neither biobanks nor research institutions can give out data without explicit consent from the patients or explicit decision by a relevant ethics committee. In such scenarios, secure GWAS can be used as a pilot study for assessing potential benefits of combined studies. In particular, there is no reason to merge the data for further analysis if a secure GWAS reveals no differentially expressed SNPs. Because such a study can be conducted in a few hours, it can significantly speed up pharmacogenetic studies and the results can be used by ethics committees to make more seasoned decisions.</p></sec><sec id="SEC5.2"><title>5.2 Servicing study data without privacy breaches</title><p>In many state-funded studies, collected data must be made accessible for public use by submitting them to a central repository. The NIH example shows a direct publication of GWAS data may cause unintended consequences even if the data are presented to the public in aggregated form (<xref ref-type="bibr" rid="btt066-B8">Couzin, 2008</xref>). One potential solution is to set up an online web service for conducting GWAS: a researcher just posts inclusion criteria for case and control groups and all computations are done by the host. In most cases, such a solution is adequate without cryptographic countermeasures. Privacy issues emerge only if researchers want to pool together data from several different repositories to detect weak associations or the inclusion criteria must remain private. In these cases, secure GWAS methodology can be applied by combining methods for international consortium studies with phenotype-based filtering (see <xref ref-type="fig" rid="btt066-F2">Fig. 2</xref>).</p></sec><sec id="SEC5.3"><title>5.3 Faster and more secure consortium studies</title><p>One of the main hurdles in GWAS is the sample size. For rare diseases, there are not enough genotyped patients to form a big enough case group. Also, over- and under-representation of sub-populations can cause spurious associations. Larger studies involving several international biobanks can diminish the impact of such problems.</p><p>Two competing alternatives to our solution in this setting are federated database systems with additional security mechanisms and hierarchical aggregation of the data.</p><p>A federated database system offers middleware that automatically binds together several sources and allows users to make various queries without knowing how the data are organized. As such, a federated database system does not solve privacy issues. Hence, one needs an honest broker&#x02014;a dedicated server with strengthened security measures that assembles the data and processes all queries (<xref ref-type="bibr" rid="btt066-B6">Boyd <italic>et al.</italic>, 2007</xref>). The latter introduces a single point of failure&#x02014;nothing can be done if the security of the honest broker is breached. Also, as the data are sent directly to the honest broker, all biobanks must have explicit clearance for releasing the data.</p><p>Hierarchical data aggregation is applicable when results of individual studies can be combined with some meta-analysis technique (e.g. <xref ref-type="bibr" rid="btt066-B39">Wolfson <italic>et al.</italic>, 2010</xref>). In such cases, the honest broker must access only aggregated summaries of individual data sources to produce the desired result. Consequently, we get stronger privacy guarantees, as the broker receives only a limited amount of information. However, unexpected privacy breaches can still occur because aggregation methods provide no explicit security guarantees and it is extremely difficult to assess how much information is leaked through summaries. Also, the approach cannot be used when members of case and control groups must be kept secret.</p><p>In a nutshell, while the alternatives are faster than our solution, they are also much more vulnerable to various attacks, and thus, privacy concerns can prevent their usage or considerably delay the initial setup time. Moreover, hierarchical data aggregation techniques can be combined with our solution. Namely, our solution can be used to replace the honest broker&#x02014;biobanks secret share the aggregated results, and thus, fewer operations must be done on shares. For the analysis part of GWAS, the resulting hybrid algorithm will only take the time given in <xref ref-type="table" rid="btt066-T5">Table 5</xref> plus a little overhead, making the computation time &#x0223c;30 s to 1 min as the filtering of case and control groups and computation of contingency tables are done locally.</p></sec><sec id="SEC5.4"><title>5.4 Long-term security in a personal genomic project</title><p>The rapid decrease of genotyping costs and moderate success in genetic diagnostics have sparkled interest in personal genomics. Companies, such as 23andMe, deCODEme and Navigenics, offer personalized genotyping services. Although participants have a right to withdraw their data at any moment, this right is enforced only by physical and organizational methods. As a consequence, a single successful outsider or insider attack can obsolete all privacy guarantees. Numerous data leakages in other areas have shown that this is an irreversible procedure. Once data have leaked, there is no way to recall them. On a shorter timescale, such events are highly improbable. However, such projects need privacy guarantees that last more than 100 years to protect participants and their offspring. In such settings, distributed storage based on secret sharing is one of the best cryptographic alternatives, as a successful breach of security of a single facility yields no information and it is possible to recover from such events.</p><p><italic>Funding</italic>: The research was supported by the <funding-source>European Regional Development Fund</funding-source> through <funding-source>Estonian Centre of Excellence in Computer Science</funding-source> and <funding-source>Software Technology and Applications Competence Center</funding-source>.</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>Supplementary Data</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_29_7_886__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_btt066_supplementary_pdf.pdf"/>
</supplementary-material>
</sec>
</body><back><ref-list><title>REFERENCES</title><ref id="btt066-B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Armitage</surname><given-names>P</given-names></name></person-group><article-title>Tests for linear trends in proportions and frequencies</article-title><source>Biometrics</source><year>1955</year><volume>11</volume><fpage>375</fpage><lpage>386</lpage></element-citation></ref><ref id="btt066-B2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ben-David</surname><given-names>A</given-names></name><etal/></person-group><article-title>FairplayMP: a system for secure multi-party computation</article-title><source>Proceedings of ACM CCS&#x02019;08</source><year>2008</year><publisher-loc>New York</publisher-loc><publisher-name>ACM</publisher-name><fpage>257</fpage><lpage>266</lpage></element-citation></ref><ref id="btt066-B3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bogdanov</surname><given-names>D</given-names></name><etal/></person-group><article-title>Sharemind: a framework for fast privacy-preserving computations</article-title><source>Proceedings of ESORICS&#x02019;08. Vol. 5283 of Lecture Notes in Computer Science</source><year>2008</year><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>192</fpage><lpage>206</lpage></element-citation></ref><ref id="btt066-B4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bogdanov</surname><given-names>D</given-names></name><etal/></person-group><article-title>Deploying secure multi-party computation for financial data analysis</article-title><source>Proceedings of Financial Cryptography 2012. Vol. 7397 of Lecture Notes in Computer Science</source><year>2012</year><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>57</fpage><lpage>64</lpage></element-citation></ref><ref id="btt066-B5"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bogetoft</surname><given-names>P</given-names></name><etal/></person-group><person-group person-group-type="editor"><name><surname>Dingledine</surname><given-names>R</given-names></name><name><surname>Golle</surname><given-names>P</given-names></name></person-group><article-title>Secure multiparty computation goes live</article-title><source>Proceedings of Financial Cryptography 2009. Vol. 5628 of Lecture Notes in Computer Science</source><year>2009</year><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>325</fpage><lpage>343</lpage></element-citation></ref><ref id="btt066-B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyd</surname><given-names>AD</given-names></name><etal/></person-group><article-title>An &#x02018;Honest Broker&#x02019; mechanism to maintain privacy for patient care and academic medical research</article-title><source>Int. J. Med. Inform.</source><year>2007</year><volume>76</volume><fpage>407</fpage><lpage>411</lpage><pub-id pub-id-type="pmid">17081800</pub-id></element-citation></ref><ref id="btt066-B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Little</surname><given-names>P</given-names></name></person-group><article-title>Nature, nurture and human disease</article-title><source>Nature</source><year>2003</year><volume>421</volume><fpage>412</fpage><lpage>414</lpage><pub-id pub-id-type="pmid">12540911</pub-id></element-citation></ref><ref id="btt066-B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>J</given-names></name></person-group><article-title>Genetic privacy. Whole-genome data not anonymous, challenging assumptions</article-title><source>Science</source><year>2008</year><volume>321</volume><fpage>1278</fpage><pub-id pub-id-type="pmid">18772401</pub-id></element-citation></ref><ref id="btt066-B9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Damg&#x000e5;rd</surname><given-names>I</given-names></name><etal/></person-group><person-group person-group-type="editor"><name><surname>Jarecki</surname><given-names>S</given-names></name><name><surname>Tsudik</surname><given-names>G</given-names></name></person-group><article-title>Asynchronous multiparty computation: theory and implementation</article-title><source>Proceedings of Public Key Cryptography 2009. Vol. 5443 of Lecture Notes in Computer Science</source><year>2009</year><publisher-loc>Heidelberg</publisher-loc><publisher-name>Springer</publisher-name><fpage>160</fpage><lpage>179</lpage></element-citation></ref><ref id="btt066-B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Moor</surname><given-names>GJE</given-names></name><etal/></person-group><article-title>Privacy enhancing techniques&#x02014;the key to secure communication and management of clinical and genomic data</article-title><source>Methods Inf. Med.</source><year>2003</year><volume>42</volume><fpage>148</fpage><lpage>153</lpage><pub-id pub-id-type="pmid">12743651</pub-id></element-citation></ref><ref id="btt066-B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dwork</surname><given-names>C</given-names></name></person-group><article-title>A firm foundation for private data analysis</article-title><source>Commun. ACM</source><year>2011</year><volume>54</volume><fpage>86</fpage><lpage>95</lpage></element-citation></ref><ref id="btt066-B12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Geisler</surname><given-names>M</given-names></name></person-group><source>Cryptographic protocols: theory and implementation</source><year>2010</year><publisher-name>PhD Thesis, Aarhus University</publisher-name></element-citation></ref><ref id="btt066-B13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname><given-names>SFA</given-names></name><name><surname>Hakonarson</surname><given-names>H</given-names></name></person-group><article-title>Recent development in pharmacogenomics: from candidate genes to genome-wide association studies</article-title><source>Expert. Rev. Mol. Diagn.</source><year>2007</year><volume>7</volume><fpage>371</fpage><lpage>393</lpage><pub-id pub-id-type="pmid">17620046</pub-id></element-citation></ref><ref id="btt066-B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gymrek</surname><given-names>M</given-names></name><etal/></person-group><article-title>Identifying personal genomes by surname inference</article-title><source>Science</source><year>2013</year><volume>339</volume><fpage>321</fpage><lpage>324</lpage><pub-id pub-id-type="pmid">23329047</pub-id></element-citation></ref><ref id="btt066-B15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamosh</surname><given-names>A</given-names></name><etal/></person-group><article-title>Online Mendelian Inheritance in Man (OMIM), a knowledgebase of human genes and genetic disorders</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>D514</fpage><lpage>D517</lpage><pub-id pub-id-type="pmid">15608251</pub-id></element-citation></ref><ref id="btt066-B16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayden</surname><given-names>EC</given-names></name></person-group><article-title>Genomics firms turn to other markets</article-title><source>Nature</source><year>2010</year><volume>463</volume><fpage>859</fpage><pub-id pub-id-type="pmid">20164890</pub-id></element-citation></ref><ref id="btt066-B17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindorff</surname><given-names>LA</given-names></name><etal/></person-group><article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2009</year><volume>106</volume><fpage>9362</fpage><lpage>9367</lpage><pub-id pub-id-type="pmid">19474294</pub-id></element-citation></ref><ref id="btt066-B18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homer</surname><given-names>N</given-names></name><etal/></person-group><article-title>Resolving individuals contributing trace amounts of DNA to highly complex mixtures using high-density SNP genotyping microarrays</article-title><source>PLoS Genet.</source><year>2008</year><volume>4</volume><fpage>e1000167</fpage><pub-id pub-id-type="pmid">18769715</pub-id></element-citation></ref><ref id="btt066-B19"><element-citation publication-type="journal"><collab>International HapMap Consortium</collab><article-title>The International HapMap Project</article-title><source>Nature</source><year>2003</year><volume>426</volume><fpage>789</fpage><lpage>796</lpage><pub-id pub-id-type="pmid">14685227</pub-id></element-citation></ref><ref id="btt066-B20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Schork</surname><given-names>NJ</given-names></name></person-group><article-title>Genetic dissection of complex traits</article-title><source>Science</source><year>1994</year><volume>265</volume><fpage>2037</fpage><lpage>2048</lpage><pub-id pub-id-type="pmid">8091226</pub-id></element-citation></ref><ref id="btt066-B21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Genetics. Genomic research and human subject privacy</article-title><source>Science</source><year>2004</year><volume>305</volume><fpage>183</fpage><pub-id pub-id-type="pmid">15247459</pub-id></element-citation></ref><ref id="btt066-B22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machanavajjhala</surname><given-names>A</given-names></name><etal/></person-group><article-title>L-diversity: privacy beyond k-anonymity</article-title><source>ACM Trans. Knowl. Discov. Data</source><year>2007</year><volume>1</volume><fpage>3</fpage></element-citation></ref><ref id="btt066-B23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malin</surname><given-names>B</given-names></name><name><surname>Sweeney</surname><given-names>L</given-names></name></person-group><article-title>Determining the identifiability of DNA database entries</article-title><source>Proc. AMIA Symp.</source><year>2000</year><fpage>537</fpage><lpage>541</lpage><pub-id pub-id-type="pmid">11079941</pub-id></element-citation></ref><ref id="btt066-B24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malin</surname><given-names>BA</given-names></name><name><surname>Sweeney</surname><given-names>LA</given-names></name></person-group><article-title>Inferring genotype from clinical phenotype through a knowledge based algorithm</article-title><source>Pac. Symp. Biocomput.</source><year>2002</year><fpage>41</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">11928494</pub-id></element-citation></ref><ref id="btt066-B25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manolio</surname><given-names>TA</given-names></name><etal/></person-group><article-title>A HapMap harvest of insights into the genetics of common disease</article-title><source>J Clin Invest</source><year>2008</year><volume>118</volume><fpage>1590</fpage><lpage>1605</lpage><pub-id pub-id-type="pmid">18451988</pub-id></element-citation></ref><ref id="btt066-B26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>JH</given-names></name><etal/></person-group><article-title>Bioinformatics challenges for genome-wide association studies</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>445</fpage><lpage>455</lpage><pub-id pub-id-type="pmid">20053841</pub-id></element-citation></ref><ref id="btt066-B27"><element-citation publication-type="journal"><collab>P3G Consortium et al.</collab><article-title>Public access to genome-wide data: five views on balancing research with privacy and protection</article-title><source>PLoS Genet.</source><year>2009</year><volume>5</volume><fpage>e1000665</fpage><pub-id pub-id-type="pmid">19798440</pub-id></element-citation></ref><ref id="btt066-B28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettersson</surname><given-names>E</given-names></name><etal/></person-group><article-title>Generations of sequencing technologies</article-title><source>Genomics</source><year>2009</year><volume>93</volume><fpage>105</fpage><lpage>111</lpage><pub-id pub-id-type="pmid">18992322</pub-id></element-citation></ref><ref id="btt066-B29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prokopenko</surname><given-names>I</given-names></name><etal/></person-group><article-title>Type 2 diabetes: new genes, new understanding</article-title><source>Trends Genet.</source><year>2008</year><volume>24</volume><fpage>613</fpage><lpage>621</lpage><pub-id pub-id-type="pmid">18952314</pub-id></element-citation></ref><ref id="btt066-B30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sasieni</surname><given-names>PD</given-names></name></person-group><article-title>From genotypes to genes: doubling the sample size</article-title><source>Biometrics</source><year>1997</year><volume>53</volume><fpage>1253</fpage><lpage>1261</lpage><pub-id pub-id-type="pmid">9423247</pub-id></element-citation></ref><ref id="btt066-B31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spielman</surname><given-names>RS</given-names></name><etal/></person-group><article-title>Transmission test for linkage disequilibrium: the insulin gene region and insulin-dependent diabetes mellitus (IDDM)</article-title><source>Am. J. Hum. Genet.</source><year>1993</year><volume>52</volume><fpage>506</fpage><lpage>516</lpage><pub-id pub-id-type="pmid">8447318</pub-id></element-citation></ref><ref id="btt066-B32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swede</surname><given-names>H</given-names></name><etal/></person-group><article-title>National population-based biobanks for genetic research</article-title><source>Genet. Med.</source><year>2007</year><volume>9</volume><fpage>141</fpage><lpage>149</lpage><pub-id pub-id-type="pmid">17413418</pub-id></element-citation></ref><ref id="btt066-B33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sweeney</surname><given-names>L</given-names></name></person-group><article-title>Achieving k-anonymity privacy protection using generalization and suppression</article-title><source>Int. J. Uncertain. Fuzz.</source><year>2002</year><volume>10</volume><fpage>571</fpage><lpage>588</lpage></element-citation></ref><ref id="btt066-B34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szymczak</surname><given-names>S</given-names></name><etal/></person-group><article-title>Machine learning in genome-wide association studies</article-title><source>Genet. Epidemiol.</source><year>2009</year><volume>33</volume><issue>Suppl. 1</issue><fpage>S51</fpage><lpage>S57</lpage><pub-id pub-id-type="pmid">19924717</pub-id></element-citation></ref><ref id="btt066-B35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varghese</surname><given-names>JS</given-names></name><name><surname>Easton</surname><given-names>DF</given-names></name></person-group><article-title>Genome-wide association studies in common cancers&#x02014;what have we learnt?</article-title><source>Curr. Opin. Genet. Dev.</source><year>2010</year><volume>20</volume><fpage>201</fpage><lpage>209</lpage><pub-id pub-id-type="pmid">20418093</pub-id></element-citation></ref><ref id="btt066-B36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visscher</surname><given-names>PM</given-names></name><name><surname>Hellard</surname><given-names>SL</given-names></name></person-group><article-title>Simple method to analyze SNP-based association studies using DNA pools</article-title><source>Genet. Epidemiol.</source><year>2003</year><volume>24</volume><fpage>291</fpage><lpage>296</lpage><pub-id pub-id-type="pmid">12687646</pub-id></element-citation></ref><ref id="btt066-B37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visscher</surname><given-names>PM</given-names></name><name><surname>Hill</surname><given-names>WG</given-names></name></person-group><article-title>The limits of individual identification from sample allele frequencies: theory and statistical analysis</article-title><source>PLoS Genet.</source><year>2009</year><volume>5</volume><fpage>e1000628</fpage><pub-id pub-id-type="pmid">19798439</pub-id></element-citation></ref><ref id="btt066-B38"><element-citation publication-type="journal"><collab>Wellcome Trust Case Control Consortium</collab><article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title><source>Nature</source><year>2007</year><volume>447</volume><fpage>661</fpage><lpage>678</lpage><pub-id pub-id-type="pmid">17554300</pub-id></element-citation></ref><ref id="btt066-B39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolfson</surname><given-names>M</given-names></name><etal/></person-group><article-title>Datashield: resolving a conflict in contemporary bioscience&#x02014;performing a pooled analysis of individual-level data without sharing the data</article-title><source>Int. J. Epidemiol.</source><year>2010</year><volume>39</volume><fpage>1372</fpage><lpage>1382</lpage><pub-id pub-id-type="pmid">20630989</pub-id></element-citation></ref><ref id="btt066-B40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zika</surname><given-names>E</given-names></name><etal/></person-group><article-title>A European survey on biobanks: trends and issues</article-title><source>Public Health Genomics</source><year>2010</year><volume>14</volume><fpage>96</fpage><lpage>103</lpage><pub-id pub-id-type="pmid">20395653</pub-id></element-citation></ref></ref-list></back></article>